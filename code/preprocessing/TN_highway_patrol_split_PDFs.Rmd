---
title: "Split TN HP PDFs"
author: "Justin Braun"
date: "2025-12-21"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries
```{r}
library(pdftools)
library(dplyr)
library(tidyr)
library(purrr)
library(stringr)
library(readxl)
```

## Global vars
```{r}
INPUT_FP <- '../../data/input/TN Highway Patrol/'
OUTPUT_FP <- '../../data/input/TN Highway Patrol/split_pdfs/'

dir.create(OUTPUT_FP, showWarnings = F)
```

## Load data
```{r}
page_numbers <- read_excel(paste0(INPUT_FP, 'HP_page_numbers.xlsx'))
```


## Split PDFs
```{r}
for (i in 1:nrow(page_numbers)) {
  cur_row <- page_numbers[i,]
  start_page <- cur_row$Start
  end_page <- cur_row$End
  cur_output <- paste0(OUTPUT_FP, cur_row$Document, '_', cur_row$EVENT, '.pdf')
  
  pdftools::pdf_subset(
    input = paste0(INPUT_FP, cur_row$Document, '.pdf'),
    pages = start_page:end_page,
    output = cur_output
  )
}

```

